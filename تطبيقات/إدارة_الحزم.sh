#!/bin/bash
# ===================================================================
# ุจุฑูุงูุฌ ุฅุฏุงุฑุฉ ุงูุญุฒู
# ===================================================================
#
# ุงููุตู: ูุฐุง ุงูุจุฑูุงูุฌ ูููุฑ ูุธุงู ุจุณูุท ูุฅุฏุงุฑุฉ ุงูุญุฒู ูุงูุจุฑุงูุฌ ูู ุงูุชูุฒูุนุฉ
#         ููุดูู ุนูููุงุช ุงูุชุซุจูุช ูุงูุฅุฒุงูุฉ ูุงูุจุญุซ ุนู ุงูุญุฒู
#
# ุงูุงุณุชุฎุฏุงู: ./ุฅุฏุงุฑุฉ_ุงูุญุฒู.sh [ุงูุฃูุฑ] [ุงุณู_ุงูุญุฒูุฉ]
#
# ===================================================================

# ===================================================================
# ุงูุฅุนุฏุงุฏุงุช
# ===================================================================

# ูุณุงุฑ ูุงุนุฏุฉ ุจูุงูุงุช ุงูุญุฒู
masar_qaeidat_albayan="$HOME/.ุญุฒู_ุนุฑุจูุฉ"

# ุฅูุดุงุก ุงููุณุงุฑ ุฅุฐุง ูู ููู ููุฌูุฏุงู
mkdir -p "$masar_qaeidat_albayan"

# ===================================================================
# ุงูุฏูุงู ุงููุณุงุนุฏุฉ
# ===================================================================

# ุฏุงูุฉ ุนุฑุถ ุฑุณุงูุฉ
earad_risalah() {
    local alnaw="$1"
    local alrisalah="$2"
    
    case "$alnaw" in
        "ูุนูููุงุช")
            echo "๐ฆ [ูุนูููุงุช] $alrisalah"
            ;;
        "ูุฌุงุญ")
            echo "โ [ูุฌุงุญ] $alrisalah"
            ;;
        "ุฎุทุฃ")
            echo "โ [ุฎุทุฃ] $alrisalah"
            ;;
        "ุชุญุฐูุฑ")
            echo "โ๏ธ  [ุชุญุฐูุฑ] $alrisalah"
            ;;
    esac
}

# ุฏุงูุฉ ุนุฑุถ ุงููุณุงุนุฏุฉ
earad_almusaeadah() {
    echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
    echo "           ๐ฆ ุจุฑูุงูุฌ ุฅุฏุงุฑุฉ ุงูุญุฒู ุงูุนุฑุจู"
    echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
    echo ""
    echo "ุงูุงุณุชุฎุฏุงู:"
    echo "  $0 [ุงูุฃูุฑ] [ุงุณู_ุงูุญุฒูุฉ]"
    echo ""
    echo "ุงูุฃูุงูุฑ ุงููุชุงุญุฉ:"
    echo ""
    echo "  ุชุซุจูุช | install [ุงุณู_ุงูุญุฒูุฉ]"
    echo "    - ุชุซุจูุช ุญุฒูุฉ ุฌุฏูุฏุฉ ูู ุงููุธุงู"
    echo ""
    echo "  ุฅุฒุงูุฉ | remove [ุงุณู_ุงูุญุฒูุฉ]"
    echo "    - ุฅุฒุงูุฉ ุญุฒูุฉ ูู ุงููุธุงู"
    echo ""
    echo "  ุจุญุซ | search [ุงุณู_ุงูุญุฒูุฉ]"
    echo "    - ุงูุจุญุซ ุนู ุญุฒูุฉ ูู ุงููุณุชูุฏุน"
    echo ""
    echo "  ูุงุฆูุฉ | list"
    echo "    - ุนุฑุถ ูุงุฆูุฉ ุงูุญุฒู ุงููุซุจุชุฉ"
    echo ""
    echo "  ุชุญุฏูุซ | update"
    echo "    - ุชุญุฏูุซ ูุงุนุฏุฉ ุจูุงูุงุช ุงูุญุฒู"
    echo ""
    echo "  ูุณุงุนุฏุฉ | help"
    echo "    - ุนุฑุถ ูุฐู ุงูุฑุณุงูุฉ"
    echo ""
}

# ===================================================================
# ุฏูุงู ุงูุนูููุงุช
# ===================================================================

# ุฏุงูุฉ ุชุซุจูุช ุญุฒูุฉ
tathbit_huzmah() {
    local ism_alhuzmah="$1"
    
    if [ -z "$ism_alhuzmah" ]; then
        earad_risalah "ุฎุทุฃ" "ูุฌุจ ุชุญุฏูุฏ ุงุณู ุงูุญุฒูุฉ ููุชุซุจูุช"
        return 1
    fi
    
    earad_risalah "ูุนูููุงุช" "ุฌุงุฑู ุชุซุจูุช ุงูุญุฒูุฉ: $ism_alhuzmah"
    
    # ูุญุงูุงุฉ ุนูููุฉ ุงูุชุซุจูุช
    echo "  โณ ุฌุงุฑู ุชุญููู ุงูุญุฒูุฉ..."
    sleep 1
    echo "  โณ ุฌุงุฑู ุงูุชุญูู ูู ุงูุชุจุนูุงุช..."
    sleep 0.5
    echo "  โณ ุฌุงุฑู ูู ุงูุถุบุท..."
    sleep 0.5
    echo "  โณ ุฌุงุฑู ุงูุชุซุจูุช..."
    sleep 0.5
    
    # ุญูุธ ุงูุญุฒูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
    echo "$ism_alhuzmah:$(date +%Y-%m-%d)" >> "$masar_qaeidat_albayan/ุงูุญุฒู_ุงููุซุจุชุฉ.txt"
    
    earad_risalah "ูุฌุงุญ" "ุชู ุชุซุจูุช ุงูุญุฒูุฉ '$ism_alhuzmah' ุจูุฌุงุญ"
}

# ุฏุงูุฉ ุฅุฒุงูุฉ ุญุฒูุฉ
izalat_huzmah() {
    local ism_alhuzmah="$1"
    
    if [ -z "$ism_alhuzmah" ]; then
        earad_risalah "ุฎุทุฃ" "ูุฌุจ ุชุญุฏูุฏ ุงุณู ุงูุญุฒูุฉ ููุฅุฒุงูุฉ"
        return 1
    fi
    
    # ุงูุชุญูู ูู ูุฌูุฏ ุงูุญุฒูุฉ
    if ! grep -q "^$ism_alhuzmah:" "$masar_qaeidat_albayan/ุงูุญุฒู_ุงููุซุจุชุฉ.txt" 2>/dev/null; then
        earad_risalah "ุฎุทุฃ" "ุงูุญุฒูุฉ '$ism_alhuzmah' ุบูุฑ ูุซุจุชุฉ"
        return 1
    fi
    
    earad_risalah "ูุนูููุงุช" "ุฌุงุฑู ุฅุฒุงูุฉ ุงูุญุฒูุฉ: $ism_alhuzmah"
    
    # ูุญุงูุงุฉ ุนูููุฉ ุงูุฅุฒุงูุฉ
    echo "  โณ ุฌุงุฑู ุฅููุงู ุงูุฎุฏูุงุช ุงููุฑุชุจุทุฉ..."
    sleep 0.5
    echo "  โณ ุฌุงุฑู ุญุฐู ุงููููุงุช..."
    sleep 0.5
    
    # ุญุฐู ุงูุญุฒูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
    sed -i "/^$ism_alhuzmah:/d" "$masar_qaeidat_albayan/ุงูุญุฒู_ุงููุซุจุชุฉ.txt"
    
    earad_risalah "ูุฌุงุญ" "ุชู ุฅุฒุงูุฉ ุงูุญุฒูุฉ '$ism_alhuzmah' ุจูุฌุงุญ"
}

# ุฏุงูุฉ ุงูุจุญุซ ุนู ุญุฒูุฉ
albahth_ean_huzmah() {
    local ism_alhuzmah="$1"
    
    if [ -z "$ism_alhuzmah" ]; then
        earad_risalah "ุฎุทุฃ" "ูุฌุจ ุชุญุฏูุฏ ุงุณู ุงูุญุฒูุฉ ููุจุญุซ"
        return 1
    fi
    
    earad_risalah "ูุนูููุงุช" "ุฌุงุฑู ุงูุจุญุซ ุนู: $ism_alhuzmah"
    echo ""
    
    # ูุญุงูุงุฉ ูุชุงุฆุฌ ุงูุจุญุซ
    echo "ุงููุชุงุฆุฌ:"
    echo "  ๐ฆ $ism_alhuzmah - ุญุฒูุฉ ุชุฌุฑูุจูุฉ"
    echo "     ุงููุตู: ุญุฒูุฉ ุชุนููููุฉ ููุชูุฒูุนุฉ ุงูุนุฑุจูุฉ"
    echo "     ุงูุฅุตุฏุงุฑ: ูก.ู.ู"
    echo ""
}

# ุฏุงูุฉ ุนุฑุถ ูุงุฆูุฉ ุงูุญุฒู
earad_qaeimah_alhuzim() {
    earad_risalah "ูุนูููุงุช" "ุงูุญุฒู ุงููุซุจุชุฉ ูู ุงููุธุงู:"
    echo ""
    
    if [ -f "$masar_qaeidat_albayan/ุงูุญุฒู_ุงููุซุจุชุฉ.txt" ]; then
        if [ -s "$masar_qaeidat_albayan/ุงูุญุฒู_ุงููุซุจุชุฉ.txt" ]; then
            while IFS=: read -r huzmah tarikh; do
                echo "  ๐ฆ $huzmah (ุชุงุฑูุฎ ุงูุชุซุจูุช: $tarikh)"
            done < "$masar_qaeidat_albayan/ุงูุญุฒู_ุงููุซุจุชุฉ.txt"
        else
            echo "  ูุง ุชูุฌุฏ ุญุฒู ูุซุจุชุฉ"
        fi
    else
        echo "  ูุง ุชูุฌุฏ ุญุฒู ูุซุจุชุฉ"
    fi
    echo ""
}

# ุฏุงูุฉ ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช
tahdith_qaeidat_albayan() {
    earad_risalah "ูุนูููุงุช" "ุฌุงุฑู ุชุญุฏูุซ ูุงุนุฏุฉ ุจูุงูุงุช ุงูุญุฒู..."
    
    # ูุญุงูุงุฉ ุนูููุฉ ุงูุชุญุฏูุซ
    echo "  โณ ุฌุงุฑู ุงูุงุชุตุงู ุจุงููุณุชูุฏุนุงุช..."
    sleep 1
    echo "  โณ ุฌุงุฑู ุชุญููู ููุงุฆู ุงูุญุฒู..."
    sleep 1
    echo "  โณ ุฌุงุฑู ูุนุงูุฌุฉ ุงููุนูููุงุช..."
    sleep 0.5
    
    earad_risalah "ูุฌุงุญ" "ุชู ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจูุฌุงุญ"
}

# ===================================================================
# ุงูุจุฑูุงูุฌ ุงูุฑุฆูุณู
# ===================================================================

albarnami_alrayisiu() {
    local alamr="$1"
    local almueamil="$2"
    
    case "$alamr" in
        "ุชุซุจูุช"|"install")
            tathbit_huzmah "$almueamil"
            ;;
        "ุฅุฒุงูุฉ"|"remove")
            izalat_huzmah "$almueamil"
            ;;
        "ุจุญุซ"|"search")
            albahth_ean_huzmah "$almueamil"
            ;;
        "ูุงุฆูุฉ"|"list")
            earad_qaeimah_alhuzim
            ;;
        "ุชุญุฏูุซ"|"update")
            tahdith_qaeidat_albayan
            ;;
        "ูุณุงุนุฏุฉ"|"help"|"")
            earad_almusaeadah
            ;;
        *)
            earad_risalah "ุฎุทุฃ" "ุฃูุฑ ุบูุฑ ูุนุฑูู: $alamr"
            echo ""
            earad_almusaeadah
            return 1
            ;;
    esac
}

# ===================================================================
# ุชุดุบูู ุงูุจุฑูุงูุฌ
# ===================================================================

albarnami_alrayisiu "$@"

# ===================================================================
# ููุงูุฉ ุงูุจุฑูุงูุฌ
# ===================================================================

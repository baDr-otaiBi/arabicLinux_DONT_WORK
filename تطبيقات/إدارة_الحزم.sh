#!/bin/bash
# ===================================================================
# ุจุฑูุงูุฌ ุฅุฏุงุฑุฉ ุงูุญุฒู - Package Manager Script
# ===================================================================
#
# ุงููุตู: ูุฐุง ุงูุจุฑูุงูุฌ ูููุฑ ูุธุงู ุจุณูุท ูุฅุฏุงุฑุฉ ุงูุญุฒู ูุงูุจุฑุงูุฌ ูู ุงูุชูุฒูุนุฉ
#         ููุดูู ุนูููุงุช ุงูุชุซุจูุช ูุงูุฅุฒุงูุฉ ูุงูุจุญุซ ุนู ุงูุญุฒู
#
# Description: This script provides a simple package management system
#              for the distribution, including install, remove, and search operations
#
# ุงูุงุณุชุฎุฏุงู: ./ุฅุฏุงุฑุฉ_ุงูุญุฒู.sh [ุงูุฃูุฑ] [ุงุณู_ุงูุญุฒูุฉ]
# Usage: ./ุฅุฏุงุฑุฉ_ุงูุญุฒู.sh [command] [package_name]
#
# ===================================================================

# ===================================================================
# ุงูุฅุนุฏุงุฏุงุช - Settings
# ===================================================================

# ูุณุงุฑ ูุงุนุฏุฉ ุจูุงูุงุช ุงูุญุฒู
# Packages database path
ูุณุงุฑ_ูุงุนุฏุฉ_ุงูุจูุงูุงุช="$HOME/.ุญุฒู_ุนุฑุจูุฉ"

# ุฅูุดุงุก ุงููุณุงุฑ ุฅุฐุง ูู ููู ููุฌูุฏุงู
# Create path if it doesn't exist
mkdir -p "$ูุณุงุฑ_ูุงุนุฏุฉ_ุงูุจูุงูุงุช"

# ===================================================================
# ุงูุฏูุงู ุงููุณุงุนุฏุฉ - Helper Functions
# ===================================================================

# ุฏุงูุฉ ุนุฑุถ ุฑุณุงูุฉ
# Display message function
ุนุฑุถ_ุฑุณุงูุฉ() {
    local ุงูููุน="$1"
    local ุงูุฑุณุงูุฉ="$2"
    
    case "$ุงูููุน" in
        "ูุนูููุงุช")
            echo "๐ฆ [ูุนูููุงุช] $ุงูุฑุณุงูุฉ"
            ;;
        "ูุฌุงุญ")
            echo "โ [ูุฌุงุญ] $ุงูุฑุณุงูุฉ"
            ;;
        "ุฎุทุฃ")
            echo "โ [ุฎุทุฃ] $ุงูุฑุณุงูุฉ"
            ;;
        "ุชุญุฐูุฑ")
            echo "โ๏ธ  [ุชุญุฐูุฑ] $ุงูุฑุณุงูุฉ"
            ;;
    esac
}

# ุฏุงูุฉ ุนุฑุถ ุงููุณุงุนุฏุฉ
# Display help function
ุนุฑุถ_ุงููุณุงุนุฏุฉ() {
    echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
    echo "  ๐ฆ ุจุฑูุงูุฌ ุฅุฏุงุฑุฉ ุงูุญุฒู ุงูุนุฑุจู - Arabic Package Manager"
    echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
    echo ""
    echo "ุงูุงุณุชุฎุฏุงู (Usage):"
    echo "  $0 [ุงูุฃูุฑ] [ุงุณู_ุงูุญุฒูุฉ]"
    echo ""
    echo "ุงูุฃูุงูุฑ ุงููุชุงุญุฉ (Available Commands):"
    echo ""
    echo "  ุชุซุจูุช | install [ุงุณู_ุงูุญุฒูุฉ]"
    echo "    - ุชุซุจูุช ุญุฒูุฉ ุฌุฏูุฏุฉ ูู ุงููุธุงู"
    echo "    - Install a new package in the system"
    echo ""
    echo "  ุฅุฒุงูุฉ | remove [ุงุณู_ุงูุญุฒูุฉ]"
    echo "    - ุฅุฒุงูุฉ ุญุฒูุฉ ูู ุงููุธุงู"
    echo "    - Remove a package from the system"
    echo ""
    echo "  ุจุญุซ | search [ุงุณู_ุงูุญุฒูุฉ]"
    echo "    - ุงูุจุญุซ ุนู ุญุฒูุฉ ูู ุงููุณุชูุฏุน"
    echo "    - Search for a package in the repository"
    echo ""
    echo "  ูุงุฆูุฉ | list"
    echo "    - ุนุฑุถ ูุงุฆูุฉ ุงูุญุฒู ุงููุซุจุชุฉ"
    echo "    - Display list of installed packages"
    echo ""
    echo "  ุชุญุฏูุซ | update"
    echo "    - ุชุญุฏูุซ ูุงุนุฏุฉ ุจูุงูุงุช ุงูุญุฒู"
    echo "    - Update packages database"
    echo ""
    echo "  ูุณุงุนุฏุฉ | help"
    echo "    - ุนุฑุถ ูุฐู ุงูุฑุณุงูุฉ"
    echo "    - Display this message"
    echo ""
}

# ===================================================================
# ุฏูุงู ุงูุนูููุงุช - Operation Functions
# ===================================================================

# ุฏุงูุฉ ุชุซุจูุช ุญุฒูุฉ
# Install package function
ุชุซุจูุช_ุญุฒูุฉ() {
    local ุงุณู_ุงูุญุฒูุฉ="$1"
    
    if [ -z "$ุงุณู_ุงูุญุฒูุฉ" ]; then
        ุนุฑุถ_ุฑุณุงูุฉ "ุฎุทุฃ" "ูุฌุจ ุชุญุฏูุฏ ุงุณู ุงูุญุฒูุฉ ููุชุซุจูุช"
        return 1
    fi
    
    ุนุฑุถ_ุฑุณุงูุฉ "ูุนูููุงุช" "ุฌุงุฑู ุชุซุจูุช ุงูุญุฒูุฉ: $ุงุณู_ุงูุญุฒูุฉ"
    
    # ูุญุงูุงุฉ ุนูููุฉ ุงูุชุซุจูุช
    # Simulate installation process
    echo "  โณ ุฌุงุฑู ุชุญููู ุงูุญุฒูุฉ..."
    sleep 1
    echo "  โณ ุฌุงุฑู ุงูุชุญูู ูู ุงูุชุจุนูุงุช..."
    sleep 0.5
    echo "  โณ ุฌุงุฑู ูู ุงูุถุบุท..."
    sleep 0.5
    echo "  โณ ุฌุงุฑู ุงูุชุซุจูุช..."
    sleep 0.5
    
    # ุญูุธ ุงูุญุฒูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
    # Save package in database
    echo "$ุงุณู_ุงูุญุฒูุฉ:$(date +%Y-%m-%d)" >> "$ูุณุงุฑ_ูุงุนุฏุฉ_ุงูุจูุงูุงุช/ุงูุญุฒู_ุงููุซุจุชุฉ.txt"
    
    ุนุฑุถ_ุฑุณุงูุฉ "ูุฌุงุญ" "ุชู ุชุซุจูุช ุงูุญุฒูุฉ '$ุงุณู_ุงูุญุฒูุฉ' ุจูุฌุงุญ"
}

# ุฏุงูุฉ ุฅุฒุงูุฉ ุญุฒูุฉ
# Remove package function
ุฅุฒุงูุฉ_ุญุฒูุฉ() {
    local ุงุณู_ุงูุญุฒูุฉ="$1"
    
    if [ -z "$ุงุณู_ุงูุญุฒูุฉ" ]; then
        ุนุฑุถ_ุฑุณุงูุฉ "ุฎุทุฃ" "ูุฌุจ ุชุญุฏูุฏ ุงุณู ุงูุญุฒูุฉ ููุฅุฒุงูุฉ"
        return 1
    fi
    
    # ุงูุชุญูู ูู ูุฌูุฏ ุงูุญุฒูุฉ
    # Check if package exists
    if ! grep -q "^$ุงุณู_ุงูุญุฒูุฉ:" "$ูุณุงุฑ_ูุงุนุฏุฉ_ุงูุจูุงูุงุช/ุงูุญุฒู_ุงููุซุจุชุฉ.txt" 2>/dev/null; then
        ุนุฑุถ_ุฑุณุงูุฉ "ุฎุทุฃ" "ุงูุญุฒูุฉ '$ุงุณู_ุงูุญุฒูุฉ' ุบูุฑ ูุซุจุชุฉ"
        return 1
    fi
    
    ุนุฑุถ_ุฑุณุงูุฉ "ูุนูููุงุช" "ุฌุงุฑู ุฅุฒุงูุฉ ุงูุญุฒูุฉ: $ุงุณู_ุงูุญุฒูุฉ"
    
    # ูุญุงูุงุฉ ุนูููุฉ ุงูุฅุฒุงูุฉ
    # Simulate removal process
    echo "  โณ ุฌุงุฑู ุฅููุงู ุงูุฎุฏูุงุช ุงููุฑุชุจุทุฉ..."
    sleep 0.5
    echo "  โณ ุฌุงุฑู ุญุฐู ุงููููุงุช..."
    sleep 0.5
    
    # ุญุฐู ุงูุญุฒูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
    # Remove package from database
    sed -i "/^$ุงุณู_ุงูุญุฒูุฉ:/d" "$ูุณุงุฑ_ูุงุนุฏุฉ_ุงูุจูุงูุงุช/ุงูุญุฒู_ุงููุซุจุชุฉ.txt"
    
    ุนุฑุถ_ุฑุณุงูุฉ "ูุฌุงุญ" "ุชู ุฅุฒุงูุฉ ุงูุญุฒูุฉ '$ุงุณู_ุงูุญุฒูุฉ' ุจูุฌุงุญ"
}

# ุฏุงูุฉ ุงูุจุญุซ ุนู ุญุฒูุฉ
# Search package function
ุงูุจุญุซ_ุนู_ุญุฒูุฉ() {
    local ุงุณู_ุงูุญุฒูุฉ="$1"
    
    if [ -z "$ุงุณู_ุงูุญุฒูุฉ" ]; then
        ุนุฑุถ_ุฑุณุงูุฉ "ุฎุทุฃ" "ูุฌุจ ุชุญุฏูุฏ ุงุณู ุงูุญุฒูุฉ ููุจุญุซ"
        return 1
    fi
    
    ุนุฑุถ_ุฑุณุงูุฉ "ูุนูููุงุช" "ุฌุงุฑู ุงูุจุญุซ ุนู: $ุงุณู_ุงูุญุฒูุฉ"
    echo ""
    
    # ูุญุงูุงุฉ ูุชุงุฆุฌ ุงูุจุญุซ
    # Simulate search results
    echo "ุงููุชุงุฆุฌ (Results):"
    echo "  ๐ฆ $ุงุณู_ุงูุญุฒูุฉ - ุญุฒูุฉ ุชุฌุฑูุจูุฉ"
    echo "     ุงููุตู: ุญุฒูุฉ ุชุนููููุฉ ููุชูุฒูุนุฉ ุงูุนุฑุจูุฉ"
    echo "     ุงูุฅุตุฏุงุฑ: 1.0.0"
    echo ""
}

# ุฏุงูุฉ ุนุฑุถ ูุงุฆูุฉ ุงูุญุฒู
# List packages function
ุนุฑุถ_ูุงุฆูุฉ_ุงูุญุฒู() {
    ุนุฑุถ_ุฑุณุงูุฉ "ูุนูููุงุช" "ุงูุญุฒู ุงููุซุจุชุฉ ูู ุงููุธุงู:"
    echo ""
    
    if [ -f "$ูุณุงุฑ_ูุงุนุฏุฉ_ุงูุจูุงูุงุช/ุงูุญุฒู_ุงููุซุจุชุฉ.txt" ]; then
        if [ -s "$ูุณุงุฑ_ูุงุนุฏุฉ_ุงูุจูุงูุงุช/ุงูุญุฒู_ุงููุซุจุชุฉ.txt" ]; then
            while IFS=: read -r ุญุฒูุฉ ุชุงุฑูุฎ; do
                echo "  ๐ฆ $ุญุฒูุฉ (ุชุงุฑูุฎ ุงูุชุซุจูุช: $ุชุงุฑูุฎ)"
            done < "$ูุณุงุฑ_ูุงุนุฏุฉ_ุงูุจูุงูุงุช/ุงูุญุฒู_ุงููุซุจุชุฉ.txt"
        else
            echo "  ูุง ุชูุฌุฏ ุญุฒู ูุซุจุชุฉ"
        fi
    else
        echo "  ูุง ุชูุฌุฏ ุญุฒู ูุซุจุชุฉ"
    fi
    echo ""
}

# ุฏุงูุฉ ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช
# Update database function
ุชุญุฏูุซ_ูุงุนุฏุฉ_ุงูุจูุงูุงุช() {
    ุนุฑุถ_ุฑุณุงูุฉ "ูุนูููุงุช" "ุฌุงุฑู ุชุญุฏูุซ ูุงุนุฏุฉ ุจูุงูุงุช ุงูุญุฒู..."
    
    # ูุญุงูุงุฉ ุนูููุฉ ุงูุชุญุฏูุซ
    # Simulate update process
    echo "  โณ ุฌุงุฑู ุงูุงุชุตุงู ุจุงููุณุชูุฏุนุงุช..."
    sleep 1
    echo "  โณ ุฌุงุฑู ุชุญููู ููุงุฆู ุงูุญุฒู..."
    sleep 1
    echo "  โณ ุฌุงุฑู ูุนุงูุฌุฉ ุงููุนูููุงุช..."
    sleep 0.5
    
    ุนุฑุถ_ุฑุณุงูุฉ "ูุฌุงุญ" "ุชู ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจูุฌุงุญ"
}

# ===================================================================
# ุงูุจุฑูุงูุฌ ุงูุฑุฆูุณู - Main Program
# ===================================================================

ุงูุจุฑูุงูุฌ_ุงูุฑุฆูุณู() {
    local ุงูุฃูุฑ="$1"
    local ุงููุนุงูู="$2"
    
    case "$ุงูุฃูุฑ" in
        "ุชุซุจูุช"|"install")
            ุชุซุจูุช_ุญุฒูุฉ "$ุงููุนุงูู"
            ;;
        "ุฅุฒุงูุฉ"|"remove")
            ุฅุฒุงูุฉ_ุญุฒูุฉ "$ุงููุนุงูู"
            ;;
        "ุจุญุซ"|"search")
            ุงูุจุญุซ_ุนู_ุญุฒูุฉ "$ุงููุนุงูู"
            ;;
        "ูุงุฆูุฉ"|"list")
            ุนุฑุถ_ูุงุฆูุฉ_ุงูุญุฒู
            ;;
        "ุชุญุฏูุซ"|"update")
            ุชุญุฏูุซ_ูุงุนุฏุฉ_ุงูุจูุงูุงุช
            ;;
        "ูุณุงุนุฏุฉ"|"help"|"")
            ุนุฑุถ_ุงููุณุงุนุฏุฉ
            ;;
        *)
            ุนุฑุถ_ุฑุณุงูุฉ "ุฎุทุฃ" "ุฃูุฑ ุบูุฑ ูุนุฑูู: $ุงูุฃูุฑ"
            echo ""
            ุนุฑุถ_ุงููุณุงุนุฏุฉ
            return 1
            ;;
    esac
}

# ===================================================================
# ุชุดุบูู ุงูุจุฑูุงูุฌ - Run Program
# ===================================================================

ุงูุจุฑูุงูุฌ_ุงูุฑุฆูุณู "$@"

# ===================================================================
# ููุงูุฉ ุงูุจุฑูุงูุฌ - End of Script
# ===================================================================

#!/bin/bash
# ===================================================================
# Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
# ===================================================================
#
# Ø§Ù„ÙˆØµÙ: Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ ÙŠÙˆÙØ± Ù†Ø¸Ø§Ù… Ø¨Ø³ÙŠØ· Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙÙŠ Ø§Ù„ØªÙˆØ²ÙŠØ¹Ø©
#         ÙˆÙŠØ´Ù…Ù„ Ø¹Ù…Ù„ÙŠØ§Øª Ø¥Ø¶Ø§ÙØ© ÙˆØ­Ø°Ù ÙˆØ¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
#
# Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…: ./Ø¥Ø¯Ø§Ø±Ø©_Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†.sh [Ø§Ù„Ø£Ù…Ø±] [Ø§Ø³Ù…_Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…]
#
# ===================================================================

# ===================================================================
# Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
# ===================================================================

# Ù…Ø³Ø§Ø± Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
masar_almustakhdimin="$HOME/.Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†_Ø¹Ø±Ø¨"

# Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ø³Ø§Ø± Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
mkdir -p "$masar_almustakhdimin"

# ===================================================================
# Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
# ===================================================================

# Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø©
earad_risalah() {
    local alnaw="$1"
    local alrisalah="$2"
    
    case "$alnaw" in
        "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª")
            echo "ðŸ‘¤ [Ù…Ø¹Ù„ÙˆÙ…Ø§Øª] $alrisalah"
            ;;
        "Ù†Ø¬Ø§Ø­")
            echo "âœ… [Ù†Ø¬Ø§Ø­] $alrisalah"
            ;;
        "Ø®Ø·Ø£")
            echo "âŒ [Ø®Ø·Ø£] $alrisalah"
            ;;
        "ØªØ­Ø°ÙŠØ±")
            echo "âš ï¸  [ØªØ­Ø°ÙŠØ±] $alrisalah"
            ;;
    esac
}

# Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
earad_almusaeadah() {
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo "           ðŸ‘¥ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†"
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    echo "Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:"
    echo "  $0 [Ø§Ù„Ø£Ù…Ø±] [Ø§Ø³Ù…_Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…]"
    echo ""
    echo "Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù…ØªØ§Ø­Ø©:"
    echo ""
    echo "  Ø¥Ø¶Ø§ÙØ© | add [Ø§Ø³Ù…_Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…]"
    echo "    - Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù†Ø¸Ø§Ù…"
    echo ""
    echo "  Ø­Ø°Ù | delete [Ø§Ø³Ù…_Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…]"
    echo "    - Ø­Ø°Ù Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù…"
    echo ""
    echo "  Ù…Ø¹Ù„ÙˆÙ…Ø§Øª | info [Ø§Ø³Ù…_Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…]"
    echo "    - Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"
    echo ""
    echo "  Ù‚Ø§Ø¦Ù…Ø© | list"
    echo "    - Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†"
    echo ""
    echo "  Ù…Ø³Ø§Ø¹Ø¯Ø© | help"
    echo "    - Ø¹Ø±Ø¶ Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø³Ø§Ù„Ø©"
    echo ""
}

# ===================================================================
# Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª
# ===================================================================

# Ø¯Ø§Ù„Ø© Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…
idafat_mustakhdim() {
    local ism_almustakhdim="$1"
    
    if [ -z "$ism_almustakhdim" ]; then
        earad_risalah "Ø®Ø·Ø£" "ÙŠØ¬Ø¨ ØªØ­Ø¯ÙŠØ¯ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"
        return 1
    fi
    
    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    if [ -f "$masar_almustakhdimin/$ism_almustakhdim.conf" ]; then
        earad_risalah "Ø®Ø·Ø£" "Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… '$ism_almustakhdim' Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„"
        return 1
    fi
    
    earad_risalah "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª" "Ø¬Ø§Ø±ÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: $ism_almustakhdim"
    
    # Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    cat > "$masar_almustakhdimin/$ism_almustakhdim.conf" << EOF
# Ù…Ù„Ù Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
# Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: $ism_almustakhdim

ism_almustakhdim="$ism_almustakhdim"
tarikh_alinsha="$(date '+%Y-%m-%d %H:%M:%S')"
almajmueat="Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†"
alsalahiat="Ø¹Ø§Ø¯ÙŠ"
alhalah="Ù†Ø´Ø·"

# Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ù„Ù
EOF
    
    # Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù„Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    mkdir -p "$masar_almustakhdimin/Ù…Ø¬Ù„Ø¯Ø§Øª/$ism_almustakhdim"
    
    earad_risalah "Ù†Ø¬Ø§Ø­" "ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… '$ism_almustakhdim' Ø¨Ù†Ø¬Ø§Ø­"
    echo "  ðŸ“ Ø§Ù„Ù…Ø¬Ù„Ø¯ Ø§Ù„Ø´Ø®ØµÙŠ: $masar_almustakhdimin/Ù…Ø¬Ù„Ø¯Ø§Øª/$ism_almustakhdim"
}

# Ø¯Ø§Ù„Ø© Ø­Ø°Ù Ù…Ø³ØªØ®Ø¯Ù…
hadf_mustakhdim() {
    local ism_almustakhdim="$1"
    
    if [ -z "$ism_almustakhdim" ]; then
        earad_risalah "Ø®Ø·Ø£" "ÙŠØ¬Ø¨ ØªØ­Ø¯ÙŠØ¯ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"
        return 1
    fi
    
    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    if [ ! -f "$masar_almustakhdimin/$ism_almustakhdim.conf" ]; then
        earad_risalah "Ø®Ø·Ø£" "Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… '$ism_almustakhdim' ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯"
        return 1
    fi
    
    earad_risalah "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª" "Ø¬Ø§Ø±ÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: $ism_almustakhdim"
    
    # Ø­Ø°Ù Ù…Ù„Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    rm -f "$masar_almustakhdimin/$ism_almustakhdim.conf"
    
    # Ø­Ø°Ù Ù…Ø¬Ù„Ø¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
    if [ -d "$masar_almustakhdimin/Ù…Ø¬Ù„Ø¯Ø§Øª/$ism_almustakhdim" ]; then
        rm -rf "$masar_almustakhdimin/Ù…Ø¬Ù„Ø¯Ø§Øª/$ism_almustakhdim"
    fi
    
    earad_risalah "Ù†Ø¬Ø§Ø­" "ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… '$ism_almustakhdim' Ø¨Ù†Ø¬Ø§Ø­"
}

# Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
earad_maelumat_almustakhdim() {
    local ism_almustakhdim="$1"
    
    if [ -z "$ism_almustakhdim" ]; then
        earad_risalah "Ø®Ø·Ø£" "ÙŠØ¬Ø¨ ØªØ­Ø¯ÙŠØ¯ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"
        return 1
    fi
    
    # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    if [ ! -f "$masar_almustakhdimin/$ism_almustakhdim.conf" ]; then
        earad_risalah "Ø®Ø·Ø£" "Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… '$ism_almustakhdim' ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯"
        return 1
    fi
    
    earad_risalah "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª" "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: $ism_almustakhdim"
    echo ""
    
    # ØªØ­Ù…ÙŠÙ„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    source "$masar_almustakhdimin/$ism_almustakhdim.conf"
    
    echo "  ðŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: $ism_almustakhdim"
    echo "  ðŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡: $tarikh_alinsha"
    echo "  ðŸ‘¥ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©: $almajmueat"
    echo "  ðŸ” Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª: $alsalahiat"
    echo "  âœ“ Ø§Ù„Ø­Ø§Ù„Ø©: $alhalah"
    echo ""
}

# Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
earad_qaeimah_almustakhdimin() {
    earad_risalah "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª" "Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…:"
    echo ""
    
    local eadad=0
    
    # Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
    for milaf in "$masar_almustakhdimin"/*.conf; do
        if [ -f "$milaf" ]; then
            source "$milaf"
            echo "  ðŸ‘¤ $ism_almustakhdim - $almajmueat ($alhalah)"
            ((eadad++))
        fi
    done
    
    if [ $eadad -eq 0 ]; then
        echo "  Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…"
    else
        echo ""
        echo "  Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†: $eadad"
    fi
    echo ""
}

# ===================================================================
# Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
# ===================================================================

albarnami_alrayisiu() {
    local alamr="$1"
    local almueamil="$2"
    
    case "$alamr" in
        "Ø¥Ø¶Ø§ÙØ©"|"add")
            idafat_mustakhdim "$almueamil"
            ;;
        "Ø­Ø°Ù"|"delete")
            hadf_mustakhdim "$almueamil"
            ;;
        "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª"|"info")
            earad_maelumat_almustakhdim "$almueamil"
            ;;
        "Ù‚Ø§Ø¦Ù…Ø©"|"list")
            earad_qaeimah_almustakhdimin
            ;;
        "Ù…Ø³Ø§Ø¹Ø¯Ø©"|"help"|"")
            earad_almusaeadah
            ;;
        *)
            earad_risalah "Ø®Ø·Ø£" "Ø£Ù…Ø± ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ: $alamr"
            echo ""
            earad_almusaeadah
            return 1
            ;;
    esac
}

# ===================================================================
# ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬
# ===================================================================

albarnami_alrayisiu "$@"

# ===================================================================
# Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬
# ===================================================================
